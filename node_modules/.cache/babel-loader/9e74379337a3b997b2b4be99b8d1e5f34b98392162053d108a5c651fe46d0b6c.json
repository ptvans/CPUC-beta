{"ast":null,"code":"const ANTHROPIC_API_ENDPOINT = 'https://api.anthropic.com/v1/messages';\nexport async function sendChatMessage(documentId, userMessage, messageHistory) {\n  try {\n    const response = await fetch(ANTHROPIC_API_ENDPOINT, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${process.env.ANTHROPIC_API_KEY}`,\n        'anthropic-version': '2024-01-01'\n      },\n      body: JSON.stringify({\n        model: 'claude-3-sonnet-20240229',\n        messages: [{\n          role: 'system',\n          content: `You are a helpful AI assistant analyzing a document. \n                     You should answer questions about document ${documentId}.\n                     Be concise and accurate in your responses.`\n        }, ...messageHistory, {\n          role: 'user',\n          content: userMessage\n        }],\n        max_tokens: 1024\n      })\n    });\n    if (!response.ok) {\n      var _errorData$error;\n      const errorData = await response.json();\n      console.error('API Error:', errorData);\n      throw new Error(`API call failed: ${((_errorData$error = errorData.error) === null || _errorData$error === void 0 ? void 0 : _errorData$error.message) || response.statusText}`);\n    }\n    const data = await response.json();\n    return data.content[0].text;\n  } catch (error) {\n    console.error('Chat API Error:', error);\n    throw new Error('Failed to get AI response. Please try again.');\n  }\n}","map":{"version":3,"names":["ANTHROPIC_API_ENDPOINT","sendChatMessage","documentId","userMessage","messageHistory","response","fetch","method","headers","process","env","ANTHROPIC_API_KEY","body","JSON","stringify","model","messages","role","content","max_tokens","ok","_errorData$error","errorData","json","console","error","Error","message","statusText","data","text"],"sources":["/Users/lappy/Sites/CPUC/src/services/chatService.js"],"sourcesContent":["const ANTHROPIC_API_ENDPOINT = 'https://api.anthropic.com/v1/messages';\n\nexport async function sendChatMessage(documentId, userMessage, messageHistory) {\n  try {\n    const response = await fetch(ANTHROPIC_API_ENDPOINT, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${process.env.ANTHROPIC_API_KEY}`,\n        'anthropic-version': '2024-01-01'\n      },\n      body: JSON.stringify({\n        model: 'claude-3-sonnet-20240229',\n        messages: [\n          {\n            role: 'system',\n            content: `You are a helpful AI assistant analyzing a document. \n                     You should answer questions about document ${documentId}.\n                     Be concise and accurate in your responses.`\n          },\n          ...messageHistory,\n          {\n            role: 'user',\n            content: userMessage\n          }\n        ],\n        max_tokens: 1024\n      })\n    });\n\n    if (!response.ok) {\n      const errorData = await response.json();\n      console.error('API Error:', errorData);\n      throw new Error(`API call failed: ${errorData.error?.message || response.statusText}`);\n    }\n\n    const data = await response.json();\n    return data.content[0].text;\n\n  } catch (error) {\n    console.error('Chat API Error:', error);\n    throw new Error('Failed to get AI response. Please try again.');\n  }\n} "],"mappings":"AAAA,MAAMA,sBAAsB,GAAG,uCAAuC;AAEtE,OAAO,eAAeC,eAAeA,CAACC,UAAU,EAAEC,WAAW,EAAEC,cAAc,EAAE;EAC7E,IAAI;IACF,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAACN,sBAAsB,EAAE;MACnDO,MAAM,EAAE,MAAM;MACdC,OAAO,EAAE;QACP,cAAc,EAAE,kBAAkB;QAClC,eAAe,EAAE,UAAUC,OAAO,CAACC,GAAG,CAACC,iBAAiB,EAAE;QAC1D,mBAAmB,EAAE;MACvB,CAAC;MACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;QACnBC,KAAK,EAAE,0BAA0B;QACjCC,QAAQ,EAAE,CACR;UACEC,IAAI,EAAE,QAAQ;UACdC,OAAO,EAAE;AACrB,kEAAkEhB,UAAU;AAC5E;QACU,CAAC,EACD,GAAGE,cAAc,EACjB;UACEa,IAAI,EAAE,MAAM;UACZC,OAAO,EAAEf;QACX,CAAC,CACF;QACDgB,UAAU,EAAE;MACd,CAAC;IACH,CAAC,CAAC;IAEF,IAAI,CAACd,QAAQ,CAACe,EAAE,EAAE;MAAA,IAAAC,gBAAA;MAChB,MAAMC,SAAS,GAAG,MAAMjB,QAAQ,CAACkB,IAAI,CAAC,CAAC;MACvCC,OAAO,CAACC,KAAK,CAAC,YAAY,EAAEH,SAAS,CAAC;MACtC,MAAM,IAAII,KAAK,CAAC,oBAAoB,EAAAL,gBAAA,GAAAC,SAAS,CAACG,KAAK,cAAAJ,gBAAA,uBAAfA,gBAAA,CAAiBM,OAAO,KAAItB,QAAQ,CAACuB,UAAU,EAAE,CAAC;IACxF;IAEA,MAAMC,IAAI,GAAG,MAAMxB,QAAQ,CAACkB,IAAI,CAAC,CAAC;IAClC,OAAOM,IAAI,CAACX,OAAO,CAAC,CAAC,CAAC,CAACY,IAAI;EAE7B,CAAC,CAAC,OAAOL,KAAK,EAAE;IACdD,OAAO,CAACC,KAAK,CAAC,iBAAiB,EAAEA,KAAK,CAAC;IACvC,MAAM,IAAIC,KAAK,CAAC,8CAA8C,CAAC;EACjE;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}